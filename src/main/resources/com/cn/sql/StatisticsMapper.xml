<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.cn.dao.StatisticsMapper" >
  <resultMap id="BaseResultMap" type="com.cn.model.Statistics" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->

    <result column="statistics" property="statistics" javaType="java.lang.String" jdbcType="VARCHAR" />

    <result column="sum_fee"  property="sumFee" jdbcType="DECIMAL" javaType="java.math.BigDecimal" />
    <result column="sum_total"   property="sumTotal" jdbcType="DECIMAL" javaType="java.math.BigDecimal" />
    <result column="sum_commission"   property="sumCommission" jdbcType="DECIMAL" javaType="java.math.BigDecimal" />
  </resultMap>

  <select id="selectPageList" parameterType="com.cn.vo.OrderEx" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    <if test="groupType== 0">
      customer_name as statistics,
    </if>
    <if test="groupType== 1">
      supplier_name as statistics,
    </if>
    sum(fee) as sum_fee,
    sum(total) as sum_total,
    sum(commission) as sum_commission
    from t_order
    where status='5'
    <if test="beginTime!= null">
      <![CDATA[AND  date_format(start_time,'%Y-%m-%d %H:%i%S') >= '${beginTime}' ]]>
    </if>
    <if test="endTime!= null">
      <![CDATA[AND   date_format(start_time,'%Y-%m-%d %H:%i%S')  <= '${endTime}']]>
    </if>
    <if test="groupType== 0">
     group by customer_id,customer_name
    </if>
    <if test="groupType== 1">
      group by supplier_id,supplier_name
    </if>
</select>

  <select id="selectSum" parameterType="com.cn.vo.OrderEx" resultMap="BaseResultMap">
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
    -->
    select
    sum(fee) as sum_fee,
    sum(total) as sum_total,
    sum(commission) as sum_commission
    from t_order
    where status='5'
    <if test="beginTime!= null">
      <![CDATA[AND  date_format(start_time,'%Y-%m-%d %H:%i%S') >= '${beginTime}' ]]>
    </if>
    <if test="endTime!= null">
      <![CDATA[AND   date_format(start_time,'%Y-%m-%d %H:%i%S')  <= '${endTime}']]>
    </if>

  </select>



</mapper>